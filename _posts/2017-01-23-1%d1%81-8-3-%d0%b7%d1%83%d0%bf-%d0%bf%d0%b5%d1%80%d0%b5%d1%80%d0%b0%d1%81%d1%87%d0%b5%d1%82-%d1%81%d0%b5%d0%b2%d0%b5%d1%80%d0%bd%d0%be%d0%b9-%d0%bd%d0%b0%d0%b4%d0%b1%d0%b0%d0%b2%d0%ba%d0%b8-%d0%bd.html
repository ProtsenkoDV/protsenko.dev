---
layout: post
status: publish
published: true
title: '1С 8.3 ЗУП: Перерасчет северной надбавки на основе уже имеющегося стажа'
author:
  display_name: Dima Protsenko
  login: Dima Protsenko
  email: ''
  url: ''
author_login: Dima Protsenko
wordpress_id: 25
date: '2017-01-23 13:25:00 +0500'
date_gmt: '2017-01-23 10:25:00 +0500'
categories:
- 1С Разработка
- ЗУП 3.1
tags: []
comments: []
---
<div dir="ltr" style="text-align: left;">
<div dir="ltr" style="text-align: left;">
<div dir="ltr" style="text-align: left;">
<div style="text-align: justify;">
<div style="clear: both; text-align: justify;"></div>
<div style="text-align: center;"><u>upd: Нижеописанные манипуляции актуальны для версии ЗУП ниже 3.1.3 </u></div>
<div style="text-align: center;"></div>
<p>Северный стаж и надбавка в Зарплате и управлением персоналом - больная тема.</p>
</div>
<div style="text-align: justify;">Проблема №1: При трудоустройстве человек имеет стаж северный 7 месяца (допустим 2 группа льготная), имеет уже надбавку 20 процентов, в итоге при принятии на работу месяц наработанный сверху 6 месяцев пропадает.</div>
<div style="text-align: justify;">Поля ввода стажа работы на севере - не работают, для чего указываются не понятно.</div>
<div style="text-align: justify;">Поэтому приходиться самому высчитывать правильный стаж, в данном случае 1С заполняет будущие значения очень механически, не думая об исключениях, а они есть.<br />
<a name="more"></a></div>
<div style="text-align: justify;">Поэтому придумано такое решение:</div>
<ol style="text-align: justify;">
<li>Открываем конфигурацию для редактирования с сохранением поддержки.</li>
<li>Справочник - ФизическиеЛица - ФормаРедактированияПроцентаСевернойНадбавки</li>
<li>Редактируем собственно эту форму, и добавляем желанную кнопку</li>
</ol>
<div style="text-align: justify;">Верное использование алгоритма неминуемо приведет к верному результату :)</div>
<ol style="text-align: justify;">
<li>Добавляем на форму кнопку, назовем ее <u>ПодсчетСтажа</u>.</li>
<li>На вкладке команды создаем Команду с названием <u>ПодсчетСтажаНаОснове</u>.</li>
<li>В параметрах команды, в свойстве Действие пишем: <u>ПодсчетСтажаНаОснове</u></li>
<li>Далее переходим на вкладку Модуль, двигаемся  в самый низ редактора исполняемого кода, и добавляем процедуру <u>ПодсчетСтажаНаОснове</u> выполняться она будет на клиенте.</li>
<li>Исходный код</li>
</ol>
</div>
<pre><code>&amp;НаКлиенте
Процедура ПодсчетСтажаНаОснове(Команда)
   ДатаПриема = ЭтотОбъект.ДатаСтажа;
   ДатаПриема = ДобавитьМесяц(ДатаПриема, -ЭтотОбъект.МесяцевСтажа);
   ДатаПриема = ДобавитьМесяц(ДатаПриема, -ЭтотОбъект.ЛетСтажа*12);
   ДатаПриема = ДатаПриема - ЭтотОбъект.ДнейСтажа*60*60*24;
   ЭтотОбъект.ПроцентыСевернойНадбавкиФизическихЛицНаборЗаписей.Очистить();
   ПерерасчетСтажаЛич = Новый Структура;  
   ПерерасчетСтажаЛич.Вставить("Период",ДатаПриема);
   ПерерасчетСтажаЛич.Вставить("ПроцентСевернойНадбавки","0");
   ЗаполнениеТЧ = ЭтотОбъект.ПроцентыСевернойНадбавкиФизическихЛицНаборЗаписей.Добавить();
   ЗаполнитьЗначенияСвойств(ЗаполнениеТЧ,ПерерасчетСтажаЛич);
   ЗаполнитьБудущиеИзмененияСДаты(Истина);
КонецПроцедуры</code></pre>
<p>Очень краткое руководство:</p>
<ol style="text-align: left;">
<li>В поле вид стажа выбираем стаж работы на севере.</li>
<li>В поле на дату пишем дату приема.</li>
<li>Указываем количество лет, месяцев, и дней.</li>
<li>Нажимаем на кнопку Подсчитать стаж исходя из общего стажа.</li>
</ol>
<p>Осознал что как-то не грамотно названы кнопки, и процедура, т.к. мы считаем северную надбавку в прошлом и будущем, а не стаж, оставлю свою ошибку на обозрение, и впредь постараюсь не допускать таких логических и лексических ошибок.</p>
</div>
</div>
